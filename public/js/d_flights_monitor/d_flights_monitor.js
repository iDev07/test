(function($){const $module_container=$('#d_flights_monitor');samo.d_flights_monitor=function(){samo.cache_controls($module_container);const _ROOT_URL=samo.ROUTES.d_flights_monitor.url;$module_container.find('.date').datePicker();let STATEFROM=$module_container.find('.STATEFROMINC');let STATETO=$module_container.find('.STATETOINC');let TOWNFROM=$module_container.find('.TOWNFROMINC');let TOWNTO=$module_container.find('.TOWNTOINC');let TOUR=$module_container.find('.TOURINC');let CLASS=$module_container.find('.CLASS');let FIRMCODE=$module_container.find('.FIRMCODE');STATEFROM.chosen();STATETO.chosen();TOWNFROM.chosen();TOWNTO.chosen();TOUR.chosen();CLASS.chosen();FIRMCODE.chosen();STATEFROM.on('change',function(){let state=$(this).val();let result={};result.STATEFROM=state;result.samo_action='STATEFROMINC';$.getScript(_ROOT_URL+$.param(result));});STATETO.on('change',function(){let state=$(this).val();let result={};result.STATETO=state;result.samo_action='STATETOINC';$.getScript(_ROOT_URL+$.param(result));});TOWNFROM.on('change',function(){let result={};result.STATEFROM=STATEFROM.val();result.STATETO=STATETO.val();result.TOWNFROM=TOWNFROM.val();result.TOWNTO=TOWNTO.val();result.samo_action='TOWNFROMINC';$.getScript(_ROOT_URL+$.param(result));});TOWNTO.on('change',function(){let result={};result.STATEFROM=STATEFROM.val();result.STATETO=STATETO.val();result.TOWNFROM=TOWNFROM.val();result.TOWNTO=TOWNTO.val();result.samo_action='TOWNTOINC';$.getScript(_ROOT_URL+$.param(result));});$module_container.find('.search.button').on('click',function(){let DATEFROM=$.controlValue($('.DATEFROM',$module_container).get(0));let DATETO=$.controlValue($('.DATETO',$module_container).get(0));if(checkFields(DATEFROM,DATETO)){let result={};result.STATEFROM=STATEFROM.val();result.STATETO=STATETO.val();result.TOWNFROM=TOWNFROM.val();result.TOWNTO=TOWNTO.val();result.TOUR=TOUR.val();result.CLASS=CLASS.val();result.PARTNER=FIRMCODE.val();result.DATEFROM=DATEFROM;result.DATETO=DATETO;result.samo_action='RESULT';$.getScript(_ROOT_URL+$.param(result));}});function checkFields(datefrom,dateto){let is_ok=true;if(!datefrom){$module_container.find('.DATEFROM').errorField(samo.i18n('MB_FIELD_ERROR'));is_ok=false;}
if(!dateto){$module_container.find('.DATETO').errorField(samo.i18n('MB_FIELD_ERROR'));is_ok=false;}
if(datefrom&&dateto&&datefrom>dateto){$module_container.find('.DATEFROM').errorField(samo.i18n('MB_FIELD_ERROR'));is_ok=false;}
return is_ok;}};$(samo.d_flights_monitor);})(samo.jQuery);