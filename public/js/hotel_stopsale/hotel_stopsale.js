"use strict";(function($){var container=samo.initModuleContainer('hotel_stopsale');samo.hotel_stopsale=function(){var _ROOT_URL=samo.ROUTES.hotel_stopsale.url,$module_container=container;var _controls=samo.cache_controls($module_container,'.STATEINC,.TOWNTO,.TOWNFROMINC,.HOTELINC');_controls.resultset=$module_container.find('.resultset');$module_container.find('select').on('change',function(){clearErrors();$(_controls.resultset).empty();});$module_container.find('.TOWNFROMINC,.STATEINC,.TOWNTO,.HOTELINC').chosen({});$(_controls.TOWNFROMINC).on('change',function(){$(_controls.STATEINC).find('option').remove();$(_controls.TOWNTO).find('option').remove();if(this.value!=0){$.getScript(getParams('TOWNFROMINC'),true);}});$(_controls.STATEINC).on('change',function(){if(this.value!=0){$.getScript(getParams('STATEINC'),true);}});$(_controls.TOWNTO).on('change',function(){if(this.value!=null){$.getScript(getParams('TOWNTO'),true);}});$module_container.find('.load').on('click',function(){if(validate({STATEINC:{error:'NOT_SET_STATEINC'},TOWNTO:{error:'NOT_SET_TOWNTO_OR_HOTELINC',group:'HOTELINC'},HOTELINC:{error:'NOT_SET_TOWNTO_OR_HOTELINC',group:'TOWNTO'}})){$.getScript(getParams('STOPSALES'),true);}});function validate(field){var checked=true;Object.keys(field).forEach(function(key){var error=field[key].error;var group=field[key].group?field[key].group:false;if(!$.controlValue(key,false,$module_container)){if(group){if(!$.controlValue(group,false,$module_container)){$(_controls[key]).errorField(samo.i18n(error));checked=false;}}else{$(_controls[key]).errorField(samo.i18n(error));checked=false;}}});return checked;}
function getParams(action){clearErrors();var useGET=arguments[1]||false;var result={};result.samo_action=action;$.each(_controls,function(i,v){var name=v.name||$(v).attr('name');if(name){var value=$.controlValue(v,useGET);if(name&&value&&value!==0){result[name]=value;}}});return _ROOT_URL+$.param(samo.getParams(result,$module_container));}
function clearErrors(){$module_container.find('.formError').remove();}};$(samo.hotel_stopsale);samo.initHotelPopup(container,{object:'span.enabled'});})(samo.jQuery);