(function($){samo.edit_tourist=function(){var lastname_lname_old=$('input[name$="LASTNAME_LNAME]"]').val();var firstname_lname_old=$('input[name$="FIRSTNAME_LNAME]"]').val();var patronymic_lname_old=$('input[name$="PATRONYMIC_LNAME]"]').val();var lastname_name_old=$('input[name$="LASTNAME_NAME]"]').val();var firstname_name_old=$('input[name$="FIRSTNAME_NAME]"]').val();var patronymic_name_old=$('input[name$="PATRONYMIC_NAME]"]').val();var _ROOT_URL=samo.ROUTES.edit_tourist.url;var $module_container=$('#edit_tourist');samo.tourist_helpers($module_container);$module_container.find('.checkForm').off('click').on('click',function(e){if(!check_fields()){e.stopPropagation();e.preventDefault();}});$module_container.on('click','.NONEX_PATRONYMIC',function(){var checked=this.checked;let checkboxes=$module_container.find('.NONEX_PATRONYMIC');let labels=checkboxes.parents('tr').prev().find('label');let inputs=checkboxes.parents('tr').prev().find('input');checkboxes.each(function(){$(this).attr('checked',checked);});inputs.each(function(){$(this).attr('disabled',checked);});if(checked){labels.each(function(){$(this).removeClass('required');});inputs.each(function(){$(this).removeClass('required').val('');});}else{labels.each(function(){$(this).addClass('required');});inputs.each(function(){$(this).addClass('required').focus();});}});$module_container.find('form').on('submit',function(e){e.stopPropagation();e.preventDefault();if(check_fields()){var action=($module_container.data('layout'))?this.action+'&is_layout=1':this.action;$.post(action,$(this).serialize(),null,'script');}
return false;});$module_container.find('[name*="[NATIONALITY]"]').on('change',function(){samo.ReloadTouristDetail($(this));});samo.ReloadTouristDetail=function($select){var $tourist=$select.closest('#edit_tourist');var params={};params.CLAIM=$tourist.data('claiminc');params.TOURIST_ID=$tourist.data('peopleinc');params.NATIONALITY=$tourist.find('[name*="[NATIONALITY]"]').val();$.post(getParams('RELOADPEOPLEDETAIL'),params,function(){$tourist.find('[name*="[IDENTITY_DOCUMENT]"]').triggerHandler('change');});};function getParams(action){var result={};result.samo_action=action;if(arguments[1]){$.extend(result,arguments[1]);}
return _ROOT_URL+$.param(result);}
function check_fields(){var is_ok=true;samo.field.clear_errors($module_container);$module_container.find('.required').not('label').each(function(){if(!$(this).val().length){is_ok=samo.field.error(samo.i18n('REQUIRED_FIELD_EMPTY'),this);return false;}});if(typeof lastname_lname_old!='undefined'&&typeof lastname_name_old!='undefined'&&lastname_lname_old!=$('input[name$="LASTNAME_LNAME]"]').val()&&lastname_name_old==$('input[name$="LASTNAME_NAME]"]').val()){if(!confirm(samo.i18n('CL_R_DO_NOT_CHANGE_CYR_LASTNAME'))){is_ok=false;return false;}}
if(typeof firstname_lname_old!='undefined'&&typeof firstname_name_old!='undefined'&&firstname_lname_old!=$('input[name$="FIRSTNAME_LNAME]"]').val()&&firstname_name_old==$('input[name$="FIRSTNAME_NAME]"]').val()){if(!confirm(samo.i18n('CL_R_DO_NOT_CHANGE_CYR_FIRSTNAME'))){is_ok=false;return false;}}
if(typeof patronymic_lname_old!='undefined'&&typeof patronymic_name_old!='undefined'&&patronymic_lname_old!=$('input[name$="PATRONYMIC_LNAME]"]').val()&&patronymic_name_old==$('input[name$="PATRONYMIC_NAME]"]').val()){if(!confirm(samo.i18n('CL_R_DO_NOT_CHANGE_CYR_PATRONYMIC'))){is_ok=false;return false;}}
if(typeof lastname_name_old!='undefined'&&typeof lastname_lname_old!='undefined'&&lastname_name_old!=$('input[name$="LASTNAME_NAME]"]').val()&&lastname_lname_old==$('input[name$="LASTNAME_LNAME]"]').val()){if(!confirm(samo.i18n('CL_R_DO_NOT_CHANGE_LAT_LASTNAME'))){is_ok=false;return false;}}
if(typeof firstname_name_old!='undefined'&&typeof firstname_lname_old!='undefined'&&firstname_name_old!=$('input[name$="FIRSTNAME_NAME]"]').val()&&firstname_lname_old==$('input[name$="FIRSTNAME_LNAME]"]').val()){if(!confirm(samo.i18n('CL_R_DO_NOT_CHANGE_LAT_FIRSTNAME'))){is_ok=false;return false;}}
if(typeof patronymic_name_old!='undefined'&&typeof patronymic_lname_old!='undefined'&&patronymic_name_old!=$('input[name$="PATRONYMIC_NAME]"]').val()&&patronymic_lname_old==$('input[name$="PATRONYMIC_LNAME]"]').val()){if(!confirm(samo.i18n('CL_R_DO_NOT_CHANGE_LAT_PATRONYMIC'))){is_ok=false;return false;}}
if(is_ok){$module_container.find('.date').each(function(){if(is_ok&&!$.valid_date(this)){is_ok=false;return false;}});}
return is_ok;}
check_fields();};if($('#edit_tourist').data('layout')){$(samo.edit_tourist);}})(samo.jQuery);