(function($){var container=samo.initModuleContainer('the_best');samo.the_best=function(container){var _ROOT_URL=samo.ROUTES.the_best.url,$module_container=container;$module_container.find('select:not([multiple="multiple"])').each(function(){$(this).chosen();const chosenEl=$(this).parent().find('.chosen-container');chosenEl.addClass($(this).attr('name')+'_chosen');});var _controls=samo.cache_controls($module_container,'select,input[type=hidden],.resultset');$('select[multiple="multiple"]').multisel().multiselfilter();samo.price_helpers($module_container);samo.price_clickable($module_container);$('.load',$module_container).on('click',function(){$.getScript(getParams('PRICES'),initResultset);});$.each(_controls,function(){$(this).on('change',function(){if($(this).is('.PACKET')||$(this).is('.TOWNFROMINC')||$(this).is('.STATEINC')){$.getScript(getParams(this.name),samo.blink_element);}});});function getParams(action){var useGET=arguments[1]||false;var result={samo_action:action};$.each(_controls,function(i,v){var name=v.name||$(v).attr('name');var value=$.controlValue(v,useGET);if(name&&value&&value!==0){if($.inArray(action,['PACKET','TOWNFROMINC','STATEINC'])!=-1||$.inArray(name,['PACKET','TOWNFROMINC','STATEINC','TOWNTOINC','GROUPSTARINC','CURRENCY'])!=-1){if(action==='PACKET'&&$.inArray(name,['TOWNFROMINC','STATEINC','TOWNTOINC','GROUPSTARINC','CURRENCY'])+1){return;}else if(action==='TOWNFROMINC'&&$.inArray(name,['STATEINC','TOWNTOINC','GROUPSTARINC','CURRENCY'])+1){return;}else if(action==='STATEINC'&&$.inArray(name,['TOWNTOINC','GROUPSTARINC','CURRENCY'])+1){return;}
result[name]=value;}}});return _ROOT_URL+samo.getParams($.param(result),$module_container);}
function initResultset(){$module_container.find('.resultset').find('td.bron').addClass('active').end().find('td.stop').addClass('notactive').end().find('table.res tr:odd td').addClass('silver');}
initResultset();$module_container.find('.searchmodes .searchmode .searchmode_button').on('mousedown keypress',function(){var $self=$(this),params={};if(!$self.data('origHref')){$self.data('origHref',this.href);}
$.each(_controls,function(i,v){const name=v.name||$(v).attr('name');const value=$.controlValue(v,false);if(name&&value!==0){params[name]=value;}});let delimiter='';const currentUrl=samo.parseURL($self.data('origHref'));if(Object.keys(currentUrl.params).length){delimiter='&';}else{delimiter='?';}
this.href=samo.buildURL($self.data('origHref')+delimiter+$.param(params));return false;});};samo.initHotelPopup(container);$(samo.the_best(container));})(samo.jQuery);